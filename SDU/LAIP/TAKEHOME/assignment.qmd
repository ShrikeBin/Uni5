---
format:
    pdf:
        include-in-header: "template_answers.tex"
mainfont: STIX Two Text
sansfont: STIX Two Text
mathfont: Latin Modern Math
---

\maketitle

In this assignmnent I will be using Tableau Prinitng function provided on github by Marco
always including it as:
```{python}
from util import tableau
```

I will also be using *numpy*, and *fractions* for matrix operations:

```{python}
import numpy as np
from fractions import Fraction
```

Throughout the Excersise a
[website](https://www.zweigmedia.com/utilities/lpg/index.html)
that was showed during lectures
will also be used as solver/visualizer

\clearpage\newpage

# Task 1

## Subtask 1.a

In the following problem:

$$
\begin{aligned}
\max \text{ }& 4x_1 + 5x_2 - 7x_3 \\
& -x_1 - x_2 + x_3 \leq 2, \\
& -5x_1 + 10x_3 \leq 10, \\
& x_1 \in [0,5], \\
& x_2 \in [-1,1], \\
& x_3 \in [-2,2].
\end{aligned}
$$

By inspection of the objective function:

$$
\begin{aligned}
4x_1 \Rightarrow 4 &\text{ is positive } \Rightarrow x_1 \text{ as large as possible}, \\
5x_2 \Rightarrow 5 &\text{ is positive } \Rightarrow x_2 \text{ as large as possible}, \\
-7x_3 \Rightarrow -7 &\text{ is negative } \Rightarrow x_3 \text{ as small as possible}.
\end{aligned}
$$

Check potential solution formed by limits of interval bounds $[x_1, x_2, x_3] = [5,1,-2]:$

$$
\begin{aligned}
\text{1st constraint: } & -x_1 - x_2 + x_3 \leq 2 \\
& -5 - 1 + (-2) \leq 2 \\
& -8 \leq 2 \quad \text{is feasible} \\
\text{2nd constraint: } & -5x_1 + 10x_3 \leq 10 \\
& -25 + 10(-2) \leq 10 \\
& -45 \leq 10 \quad \text{is feasible}
\end{aligned}
$$

$$
\begin{aligned}
\text{Objecive function value:}&\\
4x_1 + 5x_2 - 7x_3 & = \\
20 + 5 + 14 & = \\
39 &
\end{aligned}
$$

We conclude the optimal solution is $[x_1, x_2, x_3] = [5,1,-2]$

\clearpage\newpage

## Subtask 1.b

$$
\begin{aligned}
\max \;& x_1 + x_2 \\
\;& s x_1 + t x_2 \leq 1 \\
& x_1, x_2 \ge 0
\end{aligned}
$$

We can choose \(s\) and \(t\) to get different cases:

**I) Single Optimal Solution**

$$
s = 2, \quad t = 1
$$

- The slope of the only constraint is different from the slope of the objective function.  
- Geometrically, the feasible region intersects the objective function at a single vertex.  
- The vertex is our optimal solution

**II) Infinite Optimal Solutions**

$$
s = 1, \quad t = 1
$$

- The constraint line is parallel to the objective function.  
- Objective function "placed" on the face gives us infinitely many optimal solutions.

**III/IV) Infeasible / Unbounded**

- If either $s$ or $t$ (or both) are negative, the problem becomes unbounded as each variable balances the other in the constraint allowing the objective function to grow indefinitely.  
$$
s = -1, \quad t = 1 \text{ is an example of unbounded}
$$

- For any $s, t \ge 0$, setting $x_1 = \frac{1}{s}$, $x_2 = \frac{1}{t}$ gives a feasible solution (except if $s = 0$ or $t = 0$, in which case the value of $x_1$ or $x_2$ does not matter as it's multiplied by $0$).  

It is **impossible** to set $s,t$ such that the problem becomes *infeasible*, we considered all posssible cases

\clearpage\newpage


# Task 2

## Subtask 2.a

First, we transform the problem into the standard form:

- Change a minimization into a maximization:  
  $\min (c^T x)$ into $-\max - (c^T x)$.
- Replace equalities with two inequalities.  
- Convert all constraints to "$\le$".  

The result is:

$$
\begin{aligned}
\max  -3x_1 - 2x_2 - 7x_3 \\
  -x_1 + x_2 &\le 10, \\
x_1 - x_2 &\le -10, \\
-2x_1 + x_2 - x_3 &\le -10.
\end{aligned}
$$

Then the tableau looks like:

```{python}
SLACK_COUNT = 3

A = np.array([[-1, -1, 0],
              [1,  -1, 0],
              [-2, 1, -1]], dtype=object)
C = np.array([-3, -2, -7], dtype=object)
B = np.array([10, -10,-10], dtype=object)

A = np.vectorize(Fraction)(A)
C = np.vectorize(Fraction)(C)
B = np.vectorize(Fraction)(B)

I = np.array([[Fraction(int(i == j)) for j in range(SLACK_COUNT)] \
for i in range(SLACK_COUNT)], dtype=object)
Z = np.array([Fraction(0) for _ in range(SLACK_COUNT)], dtype=object)

T = np.concatenate([A.T, I], axis=1)
T = np.column_stack((T, Z))
T = np.column_stack((T, B))
T = np.vstack((T, np.concatenate([C, np.full(SLACK_COUNT, Fraction(0), \
dtype=object), [Fraction(1), Fraction(0)]])))

print("\n \n") # for pdf formating

tableau(T)
```

As we can see the tableau is **optimal** (no positive reduced costs) but **infeasible** (two of the $b_i \leq 0$), we could apply Dual Simplex to work towards feasibility

\clearpage\newpage

## Subtask 2.b

Tableau is given:

```{python}
T = np.array([[0,0,0,1,1,0,0,0],
             [0,1,1,2,0,-1,0,30],
             [1,0,1,1,0,-1,0,20],
             [0,0,2,-7,0,5,1,-120]],dtype=object)

tableau(T)
```

It is worth noting that this tableau is *unbounded* as all coefficients of $x_6$ in *A* are negative, but $x_6$ has a positive reduced cost, however we can still technically perform a change of basis and see the results.

By largest coefficient $x_6$ would have to enter (and $x_3$ leave as it's constraint is tighter) and that would make the problem infeasible, and unoptimal

```{python}
# III * -1
T[2] = T[2] * Fraction(-1, 1)

# II + III
T[1] = T[1] + T[2]

# IV - 5*III
T[3] = T[3] - 5*T[2]

tableau(T)
```

By ratio test $x_3$ enters (as $x_6$ has only negative coefficients in *A*) and $x_1$ leaves as $20/1 < 30/1$ (we ignore first line $0/0 = ?$).

Coincidentally by Bland's Rule $x_3$ enters and $x_1$ leaves (we take the lowest index)

We can follow with both of them:

```{python}
T = np.array([[0,0,0,1,1,0,0,0],
             [0,1,1,2,0,-1,0,30],
             [1,0,1,1,0,-1,0,20],
             [0,0,2,-7,0,5,1,-120]],dtype=object)


# II - III
T[1] = T[1] - T[2]

# IV - 2*III
T[3] = T[3] - 2*T[2]

tableau(T)
```

As we can see the tableau is still unbounded (by the case of $x_6$)

\clearpage\newpage


# Task 3

## Subtask 3.a

Tableau given:
```{python}
T = np.array([[1,0,1,-1,0,5],
              [0,1,-2,3,0,15],
              [0,0,-2,-2,1,-110]],dtype=object)

tableau(T)
```

From the tableau, we observe the following:

- The solution is $[x_1, x_2, x_3, x_4] = [5, 15, 0, 0]$
with objective value $110$.

- The reduced costs are $-2, -2$

- The values of dual variables are $2, 2$
(negative reduced costs).

- The shadow prices are the same as the dual variables: $2, 2$

- There is no over-capacity, as all the constraints are tight (no slacks in the basis).

\clearpage\newpage


# Task 4

## Subtask 4.a

We denote original problem as **P** and relaxed original problem as **PR**
Let's start by considering the original problem with marked constraints by $\alpha, \beta, \gamma$

$$
\begin{aligned}
\min \;& \sum_{i=1}^n c_i y_i \\
& \sum_{j=1}^m a_{ij} x_{ij} \le b_i y_i, \quad i = 1,\ldots,n \quad (\alpha) \\
& \sum_{i=1}^n x_{ij} = 1, \quad j = 1,\ldots,m \quad (\beta) \\
& y_i \le 1, \quad i = 1,\ldots,n \quad (\gamma) \\ \\
& y_i \ge 0,\quad x_{ij} \ge 0.
\end{aligned}
$$

We denote the potential dual variables:

$$
\begin{aligned}
\alpha = [\alpha_1, \ldots, \alpha_n]\\
\beta = [\beta_1, \ldots, \beta_m]\\
\gamma = [\gamma_1, \ldots, \gamma_n]\\
\end{aligned}
$$

Then measure the violation of constraints (by putting everything to one side and multiplying by corresponding dual variable):

$$
\begin{matrix}
\begin{aligned}
\alpha_1 \,(0 + b_1 y_1 - \sum_{j=1}^m a_{1j} x_{1j}) \\
\alpha_2 \,(0 + b_2 y_2 - \sum_{j=1}^m a_{2j} x_{2j}) \\
\vdots \\
\alpha_n \,(0 + b_n y_n - \sum_{j=1}^m a_{nj} x_{nj})\\
\end{aligned}
&
&
\begin{aligned}
\beta_1 \,(1 - \sum_{i=1}^n x_{i1}) \\
\beta_2 \,(1 - \sum_{i=1}^n x_{i2}) \\
\vdots \\
\beta_m \,(1 - \sum_{i=1}^n x_{im})\\
\end{aligned}
&
&
\begin{aligned}
\gamma_1 \,(1 - y_1) \\
\gamma_2 \,(1 - y_2) \\
\vdots \\
\gamma_n \,(1 - y_n)
\end{aligned}
\end{matrix}
$$

Then we denote **PR** relaxed problem:

$$
\mathrm{PR}(\alpha, \beta, \gamma)
= \mathrm{}\min\limits_{\text{by all } y, x \geq 0}
\left\{
\begin{aligned}
\vdots \\
\end{aligned}
\right\} =
$$

$$
\begin{matrix}
=\min\limits_{\text{by all } y, x \geq 0}
\left\{
\begin{aligned}
c_1 y_1 + \cdots + c_n y_n +\\
\alpha_1 \,(b_1 y_1 - \sum_{j=1}^m a_{1j} x_{1j}) +\\
\alpha_2 \,(b_2 y_2 - \sum_{j=1}^m a_{2j} x_{2j}) +\\
\vdots \\
\alpha_n \,(b_n y_n - \sum_{j=1}^m a_{nj} x_{nj}) +\\
\beta_1 \,(1 - \sum_{i=1}^n x_{i1}) +\\
\beta_2 \,(1 - \sum_{i=1}^n x_{i2}) +\\
\vdots \\
\beta_m \,(1 - \sum_{i=1}^n x_{im}) +\\
\gamma_1 \,(1 - y_1) +\\
\gamma_2 \,(1 - y_2) +\\
\vdots \\
\gamma_n \,(1 - y_n)
\end{aligned}
\right\}
&
=
&
\min\limits_{\text{by all } y, x \geq 0}
\left\{
\begin{aligned}
y_1 \,(c_1 + \alpha_1 b - \gamma_1) +\\
y_2 \,(c_2 + \alpha_2 b - \gamma_2) +\\
\vdots \\
y_1 \,(c_n + \alpha_n b - \gamma_n) +\\
x_{1,1} \,(0 - \alpha_n a_1 -\beta_1) +\\
x_{2,1} \,(0 - \alpha_2 a_1 -\beta_2) +\\
\vdots \\
x_{n,1} \,(0 - \alpha_n a_1 -\beta_n) +\\
x_{1,2} \,(0 - \alpha_1 a_2 -\beta_1) +\\
x_{2,2} \,(0 - \alpha_2 a_2 -\beta_2) +\\
\vdots \\
x_{n,m} \,(0 - \alpha_n a_m -\beta_n) +\\
\sum_{j=1}^m \beta_j +\\
\sum_{i=1}^n \gamma_i +\\
\end{aligned}
\right\}
\end{matrix}
$$

To avoid useless lower bounds we set all parts multiplied by $y,x$ $\geq 0$, (otherwise corresponding variable, for instance $x_{i,j} -> \infty$ and $\min\limits_{\text{by all } y, x \geq 0} = -\infty$) \newline 
That's how we get to the dual constraints:
$$
\begin{matrix}
\begin{aligned}
\,(c_1 + \alpha_1 b - \gamma_1) \geq 0\\
\,(c_2 + \alpha_2 b - \gamma_2) \geq 0\\
\vdots \\
\,(c_n + \alpha_n b - \gamma_n) \geq 0\\
\,(0 - \alpha_n a_1 -\beta_1) \geq 0\\
\,(0 - \alpha_2 a_1 -\beta_2) \geq 0\\
\vdots \\
\,(0 - \alpha_n a_1 -\beta_n) \geq 0\\
\,(0 - \alpha_1 a_2 -\beta_1) \geq 0\\
\,(0 - \alpha_2 a_2 -\beta_2) \geq 0\\
\vdots \\
\,(0 - \alpha_n a_m -\beta_n) \geq 0\\
\end{aligned}
&
\Rightarrow
&
\begin{aligned}
\,\alpha_1 b - \gamma_1 \geq -c_1\\
\,\alpha_2 b - \gamma_2 \geq -c_2\\
\vdots \\
\,-\alpha_n b - \gamma_n \geq -c_n\\
\,-\alpha_n a_1 -\beta_1 \geq 0\\
\,-\alpha_2 a_1 -\beta_2 \geq 0\\
\vdots \\
\,-\alpha_n a_1 -\beta_n \geq 0\\
\,-\alpha_1 a_2 -\beta_1 \geq 0\\
\,-\alpha_2 a_2 -\beta_2 \geq 0\\
\vdots \\
\,-\alpha_n a_m -\beta_n \geq 0\\
\end{aligned}
\end{matrix}
$$

To get new Objective function we take the sums uncorrelated with $y,x$ in front of the $\min_{\text{by all } y, x}\left\{\vdots \right\}.$
Now we want to:

$$
\mathrm{}\max_{\alpha, \beta, \gamma}\left\{
\mathrm{PR}(\alpha, \beta, \gamma)
= \sum_{j=1}^m \beta_j +
\sum_{i=1}^n \gamma_i + \min_{\text{by all } y, x}
\left\{
\vdots 
\right\}\right\}.
$$

However to keep the:
$$
\operatorname{opt}(\mathrm{PR}(\alpha,\beta,\gamma)) \;\le\; \operatorname{opt}(P)
$$

We need to penalize breaking the constraints. \newline
That will cause the found $\min\limits_{\text{by all } y, x \geq 0}$ to not break any constraint. \newline 
We have to make it impossible to achieve minimum when breaking the constraint. \newline
And to do that each dual variable must be chosen so that **violating a original constraint increases the value of the objective**.

For the constraints of type $\alpha \Rightarrow \sum_{j=1}^m a_{ij} x_{ij} \le b_i y_i$

- The violation measure is  
  $b_i y_i - \sum_{j=1}^m a_{ij} x_{ij}.$
- When **broken**, this becomes **negative**.
- To penalize the objective it requires  
  $\alpha_i \leq 0.$

For the constraints of type $\gamma \Rightarrow y_i \le 1$:

- The violation measure is  
  $1 - y_i.$
- When **breaking** this becomes **negative**.
- To ensure the penalty, we need  
  $\gamma_i \leq 0.$

For the constraints of type $\beta \Rightarrow \sum_{i=1}^n x_{ij} = 1$:

- Violations can happen **in both ways**.
- Therefore we set:
  $\beta_j \in \mathbb{R}.$

This ensures that always:
$$
\operatorname{opt}(\mathrm{PR}(\alpha,\beta,\gamma)) \le \operatorname{opt}(P)
$$

Combinig everything togheter we are left with:

$$
\begin{matrix}
\begin{aligned}
\max \;& \sum_{j=1}^m \beta_j + \sum_{i=1}^n \gamma_i \\
\,&\alpha_1 b - \gamma_1 \geq -c_1\\
\,&\alpha_2 b - \gamma_2 \geq -c_2\\
\,&\vdots \\
\,&-\alpha_n b - \gamma_n \geq 0\\
\,&-\alpha_n a_1 -\beta_1 \geq 0\\
\,&-\alpha_2 a_1 -\beta_2 \geq 0\\
\,&\vdots \\
\,&-\alpha_n a_1 -\beta_n \geq 0\\
\,&-\alpha_1 a_2 -\beta_1 \geq 0\\
\,&-\alpha_2 a_2 -\beta_2 \geq 0\\
\,&\vdots \\
\,&-\alpha_n a_m -\beta_n \geq 0\\\\
\,&\alpha_i \le 0. \quad i = 1,\ldots,n \quad\\
\,&\beta_j \in \mathbb{R}. \quad j = 1,\ldots,m \quad\\
\,&\gamma_i \le 0. \quad i = 1,\ldots,n \quad\\
\end{aligned}
&
\begin{matrix}
\Rightarrow\\
\text{organized as}
\end{matrix}
&
\begin{aligned}
\max \;& \sum_{j=1}^m \beta_j + \sum_{i=1}^n \gamma_i  \\\\
\,&-b\alpha_i  + \gamma_i \leq c_i \quad i = 1,\ldots,n \quad\\
\,&\alpha_i a_j + \beta_j \leq 0 \quad i = 1,\ldots,n \quad \quad j = 1,\ldots,m \quad\\\\
\,&\alpha_i \le 0. \quad i = 1,\ldots,n \quad\\
\,&\beta_j \in \mathbb{R}. \quad j = 1,\ldots,m \quad\\
\,&\gamma_i \le 0. \quad i = 1,\ldots,n \quad\\
\end{aligned}
\end{matrix}
$$

Q.E.D.

\clearpage\newpage


# Task 5

## Subtask 5.a
First write original problem with changed $\min () \Rightarrow -\max -()$ (and with slacks):
$$
c = 
\begin{bmatrix}
-1 \\ -1
\end{bmatrix}, \quad
A = 
\begin{bmatrix}
-3 & 7 & 1 & 0 \\
1 & -4 & 0 & 1
\end{bmatrix}, \quad
b = 
\begin{bmatrix}
-21 \\ 4
\end{bmatrix}, \quad
x =
\begin{bmatrix}
x_1 \\ x_2 \\ x_3 \\ x_4
\end{bmatrix}
$$

So far $B = {3, 4}$
Let's prepare for Revised Simplex:
$$
\begin{aligned}
& B = {1, 2}\\
& A_B =
\begin{bmatrix}
-3 & 7\\
1 & -4
\end{bmatrix} \quad\\
& A_B^{-1} = \frac{1}{det(A_B)} 
\begin{bmatrix}
-4 & -7\\
-1 & -3
\end{bmatrix} =
\begin{bmatrix}
-\frac{4}{5} & -\frac{7}{5}\\
-\frac{1}{5} & -\frac{3}{5}
\end{bmatrix} \quad\\
&\textit{(by using the formula for the inverse of 2x2 matrix, and det() of 2x2 matrix)}\\
& A_N =
\begin{bmatrix}
1 & 0\\
0 & 1
\end{bmatrix}\\
&c_B^T = 
\begin{bmatrix}
-1 & -1
\end{bmatrix}\\
&c_N^T = 
\begin{bmatrix}
0 & 0
\end{bmatrix}\\
\end{aligned}
$$

To check whether or not the solution with this basis is optimal we just need to compute $c_n^T - c_B^T A_B^{-1} A_N$ (new reduced costs)
which in our case can be easily done by hand:

$$
\begin{aligned}
&\begin{bmatrix}
0 & 0
\end{bmatrix} -
\begin{bmatrix}
-1 & -1
\end{bmatrix} 
\begin{bmatrix}
-\frac{4}{5} & -\frac{7}{5}\\
-\frac{1}{5} & -\frac{3}{5}
\end{bmatrix}
\begin{bmatrix}
1 & 0\\
0 & 1
\end{bmatrix} = \\
&\begin{bmatrix}
0 & 0
\end{bmatrix} -
\begin{bmatrix}
(\frac{4}{5} + \frac{1}{5}) & (\frac{7}{5} +\frac{3}{5})
\end{bmatrix} = \\
&\begin{bmatrix}
0 & 0
\end{bmatrix} -
\begin{bmatrix}
1 & 2
\end{bmatrix} = \\
&\begin{bmatrix}
-1 & -2
\end{bmatrix}
\end{aligned}
$$

As we can see all reduced costs $\leq 0$, therefore solution is optimal

\clearpage\newpage

## Subtask 5.b

Firstly we need to calculate the values $x_1,x_2,s_1,s_2$ in the optimal solution
this can be done by calculatng $A_B^{-1}b$:

$$
\begin{aligned}
A_B^{-1}b = 
\begin{bmatrix}
-\frac{4}{5} & -\frac{7}{5}\\
-\frac{1}{5} & -\frac{3}{5}
\end{bmatrix}
\begin{bmatrix}
-21 \\ 4
\end{bmatrix}
\end{aligned} = 
\begin{bmatrix}
\frac{56}{5} \\ \frac{9}{5}
\end{bmatrix}, \quad
\text{optimal basis was }
B = \begin{bmatrix}
1 \\ 2
\end{bmatrix}
$$

Therefore $x_1 = 11 \frac{1}{5}$ and $x_2 = 1 \frac{4}{5}$.
for convinience not that $s_1 = x_3$ , $s_2 = x_4$
Let's calculate new non basic $A$

$$
A_{N_{new}} = A_B^{-1}A_N = 
\begin{bmatrix}
-\frac{4}{5} & -\frac{7}{5}\\
-\frac{1}{5} & -\frac{3}{5}
\end{bmatrix}
$$

Both of the solution $x_1, x_2$ fractional, we provide Gomory cuts for both:

$$
\begin{aligned}
&\text{row }u = 1,2\\\\
&\sum_{j \in N_{new}} \big(\bar{a}_{u,j} - \lfloor \bar{a}_{u,j} \rfloor \big) x_j 
\;\ge\; \bar{b}_u - \lfloor \bar{b}_u \rfloor
\end{aligned}
$$

$$
\begin{matrix}
\begin{aligned}
&\text{Gomory cut for }u = 1\\\\
&(-\frac{4}{5} - \lfloor{-\frac{4}{5}}\rfloor)s_1 + 
(-\frac{9}{5} - \lfloor{-\frac{9}{5}}\rfloor)s_1 \geq
\frac{56}{5} - \lfloor{\frac{56}{5}}\rfloor \\\\
&\frac{1}{5}s_1 + \frac{3}{5}s_2 \geq \frac{1}{5}\\\\
&s_1 + 3s_2 \geq 1\\\\
\end{aligned}
&
&
\begin{aligned}
&\text{Gomory cut for }u = 2\\\\
&(-\frac{1}{5} - \lfloor{-\frac{1}{5}}\rfloor)s_1 + 
(-\frac{3}{5} - \lfloor{-\frac{3}{5}}\rfloor)s_1 \geq
\frac{9}{5} - \lfloor{\frac{9}{5}}\rfloor \\\\
&\frac{4}{5}s_1 + \frac{2}{5}s_2 \geq \frac{4}{5}\\\\
&4s_1 + 2s_2 \geq 4\\\\
\end{aligned}
\end{matrix}
$$

We can express them in terms of the original variables by substitution, using the equalities from standard form:
$$
\begin{aligned}
&-3x_1 + 7x_2 + s_1 = -21 \\
&x_1 - 4x_2 + s_2 = 4 \\\\
&s_1 = -21 +3x_1 -7x_2\\
&s_2 = 4-x_1 +4x_2
\end{aligned}
$$

$$
\begin{matrix}
\begin{aligned}
&\text{Gomory cut for }u = 1\\\\
&s_1 + 3s_2 \geq 1\\\\
&-21+3x_1-7x_2\\
&+12-3x_1+12x_2 \geq 1\\\\
&-9 + 5x_2 \geq 1\\\\
&x_2 \geq -2
\end{aligned}
&
&
\begin{aligned}
&\text{Gomory cut for }u = 2\\\\
&4s_1 + 2s_2 \geq 4\\\\
&-84+12x_1-28x_2\\
&+8-2x_1+8x_2 \geq 4\\\\
&-76 +10x_1 - 20x_2 \geq 4\\\\
&x_1 - 2x_2 \geq 8
\end{aligned}
\end{matrix}
$$

\clearpage\newpage

## Subtask 5.c
[Website](https://www.zweigmedia.com/utilities/lpg/index.html) was used as a visualizer \newline
$x_2 \geq -2$ is not visible as it's weaker than base constraints $x_1,x_2 \geq 0$

| without Gomory cuts | with Gomory cuts |
|------------------|-----------------|
| ![](before.png){width=50%} | ![](after.png){width=50%} |
\clearpage\newpage


# Task 6

## Subtask 6.a

$$
\begin{aligned}
\min \;& x - 2y \\
\text{s.t. } & -4x + 6y \le 9 \\
& x + y \le 4 \\
& x, y \in \mathbb{N}
\end{aligned}
$$


As the problem has only 2 variables
[website](https://www.zweigmedia.com/utilities/lpg/index.html) was used as a visualizer and solver. \newline
Nodes were opened in alphabetical order (i.e. A $\rightarrow$ B $\rightarrow$ C ...)

\begin{tikzpicture}[
  node distance=1.5cm, % reduced spacing
  every node/.style={draw, rectangle, rounded corners, align=center, font=\small},
  every edge/.style={->, >=stealth}
]

% Nodes
\node (A) {A\\$db=-3\frac{1}{2}$\\$s=[1\frac{1}{2}, 2\frac{1}{2}]$};
\node (B) [below left=of A] {B\\$db=-3\frac{1}{3}$\\$s=[1, 2\frac{1}{6}]$};
\node (C) [below right=of A] {C\\$db=-2$\\$s=[2, 2]$};
\node (D) [below left=of B] {D\\$db=-3\frac{1}{4}$\\$s=[\frac{3}{4}, 2]$};
\node (E) [below right=of B] {E\\infeasible};
\node (F) [below left=of D] {F\\$db=-3$\\$s=[0, 1\frac{1}{2}]$};
\node (G) [below right=of D] {G\\$db=-3$\\$s=[1, 2]$};

% Edges
\draw (A) -- (B) node[draw = none, midway, left] {$x \le 1$};
\draw (A) -- (C) node[draw = none, midway, right] {$x \ge 2$};
\draw (B) -- (D) node[draw = none, midway, left] {$y \le 2$};
\draw (B) -- (E) node[draw = none, midway, right] {$y \ge 3$};
\draw (D) -- (F) node[draw = none, midway, left] {$x \leq 0$};
\draw (D) -- (G) node[draw = none, midway, right] {$x \geq 1$};

%Prunes
\node[below=2mm of C, draw = none, font=\footnotesize, align=center] {$\textit{pruned by optimality}$};
\node[below=2mm of E, draw = none, font=\footnotesize, align=center] {$\textit{pruned by infeasibility}$};
\node[below=2mm of F, draw = none, font=\footnotesize, align=center] {$\textit{pruned by objective value}$};
\node[below=2mm of G, draw = none, font=\footnotesize, align=center] {$\textcolor{DarkGreen}{Optimal}$};

\end{tikzpicture}

\clearpage\newpage


# Task 7

## Subtask 7.a
Firstly let us note *Hamming Distance* $H_d$ between two words $w_i, w_j$ of lenght $d$\newline
i.e. $w_i, w_j \in \left\{\mathbf{0},\mathbf{1}\right\}^d$
$$
H_d(w_i, w_j)
= \sum_{k=1}^{d} \mathbf{1}\!\left( w_i[k] \neq w_j[k] \right)
$$

$k$ being the index of a word being checked and $\mathbf{1}$ indicator function \newline

Our problem can then be expressed as:
$$
\max\limits_{}\left\{\min\limits{}
\left\{
  H_d(w_i,w_j)
\right\}
\right\} \text{  for } i,i \in \left\{1 \cdots N\right\}
$$

across all $w_i \neq w_j$ of $|w_i| = |w_j|$ \newline

We transform it into *Mathematical Programming form* by first denoting:
$$
M_d = 
\min\limits{}
\left\{
  H_d(w_i,w_j)
\right\}\text{  for } i,i \in \left\{1 \cdots N\right\}
$$

And subsequently transforming the formulation into:

$$
\begin{aligned}
&\max\limits_{} M_d \\
&\sum_{k=1}^{d} \mathbf{1}\!\left( w_i[k] \neq w_j[k] \right) \geq M_d \\
&\text{for } 1 \leq i < j \leq N
\end{aligned}
$$

To make the constraints more workable:

$$
\begin{aligned}
&\max\limits_{} M_d \\
&\sum_{k=1}^{d} | w_i[k] -w_j[k] | \geq M_d \\
&\text{for } 1 \leq i < j \leq N \\
&\mathop{\forall}\limits_{j,k,i} \text{  } w_i[k], w_j[k] \in \left\{\mathbf{0},\mathbf{1}\right\}
\end{aligned}
$$

This formulation has exactly $\frac{N(N-1)}{2}$ constraints (all unique pairs)
and $N \cdot d$ variables ($N$ words of lenght $d$) \newline
We would like however to get rid of not explicitily linear absolute value in the constraints. We can do that by introductiong another variable that will replace it, let's call it $\gamma$:

$$
\gamma_{i,j,k} \approx | w_i[k] -w_j[k] |
$$

We have to bound it so that in all possible situations it is forced to hold a correct value:

$$
\begin{matrix}
\begin{aligned}
&\gamma_{i,j,k} \leq 2 - (w_i[k] +w_j[k])\\
&\gamma_{i,j,k} \leq w_i[k] +w_j[k]\\
&\gamma_{i,j,k} \geq w_i[k] -w_j[k]\\
&\gamma_{i,j,k} \geq w_j[k] -w_i[k]  
\end{aligned}
\end{matrix}
$$

We can se that using those we can replace absolute value in all cases:

$$
\begin{matrix}
\begin{aligned}
& w_i[k] , w_j[k] = (0,0)\\\\
&\gamma_{i,j,k} \leq 2\\
&\gamma_{i,j,k} \leq 0\\
&\gamma_{i,j,k} \geq 0\\
&\gamma_{i,j,k} \geq 0\\
&\Rightarrow \gamma_{i,j,k} = 0  
\end{aligned}
&
\quad \quad\
&
\begin{aligned}
& w_i[k] , w_j[k] = (1,1)\\\\
&\gamma_{i,j,k} \leq 0\\
&\gamma_{i,j,k} \leq 2\\
&\gamma_{i,j,k} \geq 0\\
&\gamma_{i,j,k} \geq 0 \\
&\Rightarrow \gamma_{i,j,k} = 0   
\end{aligned}
\\
\\
\begin{aligned}
& w_i[k] , w_j[k] = (0,1)\\\\
&\gamma_{i,j,k} \leq 1\\
&\gamma_{i,j,k} \leq 1\\
&\gamma_{i,j,k} \geq -1\\
&\gamma_{i,j,k} \geq 1  \\
&\Rightarrow \gamma_{i,j,k} = 1
\end{aligned}
&
\quad \quad\
&
\begin{aligned}
& w_i[k] , w_j[k] = (1,0)\\\\
&\gamma_{i,j,k} \leq 1\\
&\gamma_{i,j,k} \leq 1\\
&\gamma_{i,j,k} \geq 1\\
&\gamma_{i,j,k} \geq -1 \\
&\Rightarrow \gamma_{i,j,k} = 1   
\end{aligned}
\end{matrix}
$$

Combinig that our new formulation looks as follows:

$$
\begin{aligned}
&\max\limits_{} M_d \\
&\left\{\sum_{k=1}^{d} \gamma_{i,j,k} \geq M_d \right\}\quad 1 \leq i < j \leq N \\
&\left\{\begin{aligned}
&\gamma_{i,j,k} \leq 2 - (w_i[k] +w_j[k])\\
&\gamma_{i,j,k} \leq w_i[k] +w_j[k]\\
&\gamma_{i,j,k} \geq w_i[k] -w_j[k]\\
&\gamma_{i,j,k} \geq w_j[k] -w_i[k] \\
\end{aligned}\right\}
\begin{aligned}
&1 \leq i < j \leq N \\\\
&1 \leq k \leq d
\end{aligned}\\
&\mathop{\forall}\limits_{j,k,i}\text{  } \gamma_{i,j,k} \in \mathbb{R}\\
&\mathop{\forall}\limits_{j,k,i} \text{  } w_i[k], w_j[k] \in \left\{\mathbf{0},\mathbf{1}\right\}
\end{aligned}
$$

That yields a total of ($\frac{N(N-1)}{2} + 4d\frac{N(N-1)}{2}$) constraints
and ($N \cdot d + d\frac{N(N-1)}{2}$) variables ($w_i[k] + \gamma_{i,j,k}$) \newline

\clearpage\newpage

## Subtask 7.b

$$
\begin{aligned}
&\max\limits_{} M_d \\\\
&\sum_{k=1}^{d} \gamma_{i,j,k} \geq M_d \quad \quad 1 \leq i < j \leq N \\
&\begin{aligned}
&\gamma_{i,j,k} \leq 2 - (w_i[k] +w_j[k])\\
&\gamma_{i,j,k} \leq w_i[k] +w_j[k]\\
&\gamma_{i,j,k} \geq w_i[k] -w_j[k]\\
&\gamma_{i,j,k} \geq w_j[k] -w_i[k] \\
\end{aligned}\quad
\begin{aligned}
&1 \leq i < j \leq N \\\\
&1 \leq k \leq d
\end{aligned}\\\\
&\mathop{\forall}\limits_{j,k,i}\text{  } \gamma_{i,j,k} \in \mathbb{R}\\
&\mathop{\forall}\limits_{j,k,i} \text{  } w_i[k], w_j[k] \in \left\{\mathbf{0},\mathbf{1}\right\}
\end{aligned}
$$

In the final formulation the problem belongs to the **Mixed Integer Lineary Programming** family as its constraints are all linear and some of the variables ($\gamma$) can be real, the other ($w_i[k]$) integer. It's worth noting however that all integer variables here are **binary** therefore it's more of a *Mixed Binary Lineary Programming*, which *might* be a bit easier to solve than regular *Integer* programming.

\clearpage\newpage


# Task 8

## Subtask 8.a
\clearpage\newpage

## Subtask 8.b
\clearpage\newpage

## Subtask 8.c 
\clearpage\newpage

## Subtask 8.d 
\clearpage\newpage

## Subtask 8.e
\clearpage\newpage

## Subtask 8.f
\clearpage\newpage